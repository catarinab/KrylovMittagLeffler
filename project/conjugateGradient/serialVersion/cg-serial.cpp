#include <iostream>
#include <vector>
#include <cstdlib>
#include <omp.h>
#include "io_ops.cpp"

using namespace std;

#define epsilon 0.001
#define MAXITER 100

bool debug = false;
string input_file;

//construir tendo em conta as matrizes do matlab?
//paralelizar e distribuir por blocos?

//positive definite matrix !! (symmetric matrix whose every eigenvalue is positive.)
vector<vector<double>> buildMatrix(string input_file) {
    return readFile_mtx(input_file);
}

//construir tendo em conta as matrizes do matlab?
vector<double> buildVector(string input_file) {
    vector<double> b(2000);
    b[0]=83;
    b[1]=86;
    b[2]=77;
    b[3]=15;
    b[4]=93;
    b[5]=35;
    b[6]=86;
    b[7]=92;
    b[8]=49;
    b[9]=21;
    b[10]=62;
    b[11]=27;
    b[12]=90;
    b[13]=59;
    b[14]=63;
    b[15]=26;
    b[16]=40;
    b[17]=26;
    b[18]=72;
    b[19]=36;
    b[20]=11;
    b[21]=68;
    b[22]=67;
    b[23]=29;
    b[24]=82;
    b[25]=30;
    b[26]=62;
    b[27]=23;
    b[28]=67;
    b[29]=35;
    b[30]=29;
    b[31]=2;
    b[32]=22;
    b[33]=58;
    b[34]=69;
    b[35]=67;
    b[36]=93;
    b[37]=56;
    b[38]=11;
    b[39]=42;
    b[40]=29;
    b[41]=73;
    b[42]=21;
    b[43]=19;
    b[44]=84;
    b[45]=37;
    b[46]=98;
    b[47]=24;
    b[48]=15;
    b[49]=70;
    b[50]=13;
    b[51]=26;
    b[52]=91;
    b[53]=80;
    b[54]=56;
    b[55]=73;
    b[56]=62;
    b[57]=70;
    b[58]=96;
    b[59]=81;
    b[60]=5;
    b[61]=25;
    b[62]=84;
    b[63]=27;
    b[64]=36;
    b[65]=5;
    b[66]=46;
    b[67]=29;
    b[68]=13;
    b[69]=57;
    b[70]=24;
    b[71]=95;
    b[72]=82;
    b[73]=45;
    b[74]=14;
    b[75]=67;
    b[76]=34;
    b[77]=64;
    b[78]=43;
    b[79]=50;
    b[80]=87;
    b[81]=8;
    b[82]=76;
    b[83]=78;
    b[84]=88;
    b[85]=84;
    b[86]=3;
    b[87]=51;
    b[88]=54;
    b[89]=99;
    b[90]=32;
    b[91]=60;
    b[92]=76;
    b[93]=68;
    b[94]=39;
    b[95]=12;
    b[96]=26;
    b[97]=86;
    b[98]=94;
    b[99]=39;
    b[100]=95;
    b[101]=70;
    b[102]=34;
    b[103]=78;
    b[104]=67;
    b[105]=1;
    b[106]=97;
    b[107]=2;
    b[108]=17;
    b[109]=92;
    b[110]=52;
    b[111]=56;
    b[112]=1;
    b[113]=80;
    b[114]=86;
    b[115]=41;
    b[116]=65;
    b[117]=89;
    b[118]=44;
    b[119]=19;
    b[120]=40;
    b[121]=29;
    b[122]=31;
    b[123]=17;
    b[124]=97;
    b[125]=71;
    b[126]=81;
    b[127]=75;
    b[128]=9;
    b[129]=27;
    b[130]=67;
    b[131]=56;
    b[132]=97;
    b[133]=53;
    b[134]=86;
    b[135]=65;
    b[136]=6;
    b[137]=83;
    b[138]=19;
    b[139]=24;
    b[140]=28;
    b[141]=71;
    b[142]=32;
    b[143]=29;
    b[144]=3;
    b[145]=19;
    b[146]=70;
    b[147]=68;
    b[148]=8;
    b[149]=15;
    b[150]=40;
    b[151]=49;
    b[152]=96;
    b[153]=23;
    b[154]=18;
    b[155]=45;
    b[156]=46;
    b[157]=51;
    b[158]=21;
    b[159]=55;
    b[160]=79;
    b[161]=88;
    b[162]=64;
    b[163]=28;
    b[164]=41;
    b[165]=50;
    b[166]=93;
    b[167]=0;
    b[168]=34;
    b[169]=64;
    b[170]=24;
    b[171]=14;
    b[172]=87;
    b[173]=56;
    b[174]=43;
    b[175]=91;
    b[176]=27;
    b[177]=65;
    b[178]=59;
    b[179]=36;
    b[180]=32;
    b[181]=51;
    b[182]=37;
    b[183]=28;
    b[184]=75;
    b[185]=7;
    b[186]=74;
    b[187]=21;
    b[188]=58;
    b[189]=95;
    b[190]=29;
    b[191]=37;
    b[192]=35;
    b[193]=93;
    b[194]=18;
    b[195]=28;
    b[196]=43;
    b[197]=11;
    b[198]=28;
    b[199]=29;
    b[200]=76;
    b[201]=4;
    b[202]=43;
    b[203]=63;
    b[204]=13;
    b[205]=38;
    b[206]=6;
    b[207]=40;
    b[208]=4;
    b[209]=18;
    b[210]=28;
    b[211]=88;
    b[212]=69;
    b[213]=17;
    b[214]=17;
    b[215]=96;
    b[216]=24;
    b[217]=43;
    b[218]=70;
    b[219]=83;
    b[220]=90;
    b[221]=99;
    b[222]=72;
    b[223]=25;
    b[224]=44;
    b[225]=90;
    b[226]=5;
    b[227]=39;
    b[228]=54;
    b[229]=86;
    b[230]=69;
    b[231]=82;
    b[232]=42;
    b[233]=64;
    b[234]=97;
    b[235]=7;
    b[236]=55;
    b[237]=4;
    b[238]=48;
    b[239]=11;
    b[240]=22;
    b[241]=28;
    b[242]=99;
    b[243]=43;
    b[244]=46;
    b[245]=68;
    b[246]=40;
    b[247]=22;
    b[248]=11;
    b[249]=10;
    b[250]=5;
    b[251]=1;
    b[252]=61;
    b[253]=30;
    b[254]=78;
    b[255]=5;
    b[256]=20;
    b[257]=36;
    b[258]=44;
    b[259]=26;
    b[260]=22;
    b[261]=65;
    b[262]=8;
    b[263]=16;
    b[264]=82;
    b[265]=58;
    b[266]=24;
    b[267]=37;
    b[268]=62;
    b[269]=24;
    b[270]=0;
    b[271]=36;
    b[272]=52;
    b[273]=99;
    b[274]=79;
    b[275]=50;
    b[276]=68;
    b[277]=71;
    b[278]=73;
    b[279]=31;
    b[280]=81;
    b[281]=30;
    b[282]=33;
    b[283]=94;
    b[284]=60;
    b[285]=63;
    b[286]=99;
    b[287]=81;
    b[288]=99;
    b[289]=96;
    b[290]=59;
    b[291]=73;
    b[292]=13;
    b[293]=68;
    b[294]=90;
    b[295]=95;
    b[296]=26;
    b[297]=66;
    b[298]=84;
    b[299]=40;
    b[300]=90;
    b[301]=84;
    b[302]=76;
    b[303]=42;
    b[304]=36;
    b[305]=7;
    b[306]=45;
    b[307]=56;
    b[308]=79;
    b[309]=18;
    b[310]=87;
    b[311]=12;
    b[312]=48;
    b[313]=72;
    b[314]=59;
    b[315]=9;
    b[316]=36;
    b[317]=10;
    b[318]=42;
    b[319]=87;
    b[320]=6;
    b[321]=1;
    b[322]=13;
    b[323]=72;
    b[324]=21;
    b[325]=55;
    b[326]=19;
    b[327]=99;
    b[328]=21;
    b[329]=4;
    b[330]=39;
    b[331]=11;
    b[332]=40;
    b[333]=67;
    b[334]=5;
    b[335]=28;
    b[336]=27;
    b[337]=50;
    b[338]=84;
    b[339]=58;
    b[340]=20;
    b[341]=24;
    b[342]=22;
    b[343]=69;
    b[344]=96;
    b[345]=81;
    b[346]=30;
    b[347]=84;
    b[348]=92;
    b[349]=72;
    b[350]=72;
    b[351]=50;
    b[352]=25;
    b[353]=85;
    b[354]=22;
    b[355]=99;
    b[356]=40;
    b[357]=42;
    b[358]=98;
    b[359]=13;
    b[360]=98;
    b[361]=90;
    b[362]=24;
    b[363]=90;
    b[364]=9;
    b[365]=81;
    b[366]=19;
    b[367]=36;
    b[368]=32;
    b[369]=55;
    b[370]=94;
    b[371]=4;
    b[372]=79;
    b[373]=69;
    b[374]=73;
    b[375]=76;
    b[376]=50;
    b[377]=55;
    b[378]=60;
    b[379]=42;
    b[380]=79;
    b[381]=84;
    b[382]=93;
    b[383]=5;
    b[384]=21;
    b[385]=67;
    b[386]=4;
    b[387]=13;
    b[388]=61;
    b[389]=54;
    b[390]=26;
    b[391]=59;
    b[392]=44;
    b[393]=2;
    b[394]=2;
    b[395]=6;
    b[396]=84;
    b[397]=21;
    b[398]=42;
    b[399]=68;
    b[400]=28;
    b[401]=89;
    b[402]=72;
    b[403]=8;
    b[404]=58;
    b[405]=98;
    b[406]=36;
    b[407]=8;
    b[408]=53;
    b[409]=48;
    b[410]=3;
    b[411]=33;
    b[412]=33;
    b[413]=48;
    b[414]=90;
    b[415]=54;
    b[416]=67;
    b[417]=46;
    b[418]=68;
    b[419]=29;
    b[420]=0;
    b[421]=46;
    b[422]=88;
    b[423]=97;
    b[424]=49;
    b[425]=90;
    b[426]=3;
    b[427]=33;
    b[428]=63;
    b[429]=97;
    b[430]=53;
    b[431]=92;
    b[432]=86;
    b[433]=25;
    b[434]=52;
    b[435]=96;
    b[436]=75;
    b[437]=88;
    b[438]=57;
    b[439]=29;
    b[440]=36;
    b[441]=60;
    b[442]=14;
    b[443]=21;
    b[444]=60;
    b[445]=4;
    b[446]=28;
    b[447]=27;
    b[448]=50;
    b[449]=48;
    b[450]=56;
    b[451]=2;
    b[452]=94;
    b[453]=97;
    b[454]=99;
    b[455]=43;
    b[456]=39;
    b[457]=2;
    b[458]=28;
    b[459]=3;
    b[460]=0;
    b[461]=81;
    b[462]=47;
    b[463]=38;
    b[464]=59;
    b[465]=51;
    b[466]=35;
    b[467]=34;
    b[468]=39;
    b[469]=92;
    b[470]=15;
    b[471]=27;
    b[472]=4;
    b[473]=29;
    b[474]=49;
    b[475]=64;
    b[476]=85;
    b[477]=29;
    b[478]=43;
    b[479]=35;
    b[480]=77;
    b[481]=0;
    b[482]=38;
    b[483]=71;
    b[484]=49;
    b[485]=89;
    b[486]=67;
    b[487]=88;
    b[488]=92;
    b[489]=95;
    b[490]=43;
    b[491]=44;
    b[492]=29;
    b[493]=90;
    b[494]=82;
    b[495]=40;
    b[496]=41;
    b[497]=69;
    b[498]=26;
    b[499]=32;
    b[500]=61;
    b[501]=42;
    b[502]=60;
    b[503]=17;
    b[504]=23;
    b[505]=61;
    b[506]=81;
    b[507]=9;
    b[508]=90;
    b[509]=25;
    b[510]=96;
    b[511]=67;
    b[512]=77;
    b[513]=34;
    b[514]=90;
    b[515]=26;
    b[516]=24;
    b[517]=57;
    b[518]=14;
    b[519]=68;
    b[520]=5;
    b[521]=58;
    b[522]=12;
    b[523]=86;
    b[524]=0;
    b[525]=46;
    b[526]=26;
    b[527]=94;
    b[528]=16;
    b[529]=52;
    b[530]=78;
    b[531]=29;
    b[532]=46;
    b[533]=90;
    b[534]=47;
    b[535]=70;
    b[536]=51;
    b[537]=80;
    b[538]=31;
    b[539]=93;
    b[540]=57;
    b[541]=27;
    b[542]=12;
    b[543]=86;
    b[544]=14;
    b[545]=55;
    b[546]=12;
    b[547]=90;
    b[548]=12;
    b[549]=79;
    b[550]=10;
    b[551]=69;
    b[552]=89;
    b[553]=74;
    b[554]=55;
    b[555]=41;
    b[556]=20;
    b[557]=33;
    b[558]=87;
    b[559]=88;
    b[560]=38;
    b[561]=66;
    b[562]=70;
    b[563]=84;
    b[564]=56;
    b[565]=17;
    b[566]=6;
    b[567]=60;
    b[568]=49;
    b[569]=37;
    b[570]=5;
    b[571]=59;
    b[572]=17;
    b[573]=18;
    b[574]=45;
    b[575]=83;
    b[576]=73;
    b[577]=58;
    b[578]=73;
    b[579]=37;
    b[580]=89;
    b[581]=83;
    b[582]=7;
    b[583]=78;
    b[584]=57;
    b[585]=14;
    b[586]=71;
    b[587]=29;
    b[588]=0;
    b[589]=59;
    b[590]=18;
    b[591]=38;
    b[592]=25;
    b[593]=88;
    b[594]=74;
    b[595]=33;
    b[596]=57;
    b[597]=81;
    b[598]=93;
    b[599]=58;
    b[600]=70;
    b[601]=99;
    b[602]=17;
    b[603]=39;
    b[604]=69;
    b[605]=63;
    b[606]=22;
    b[607]=94;
    b[608]=73;
    b[609]=47;
    b[610]=31;
    b[611]=62;
    b[612]=82;
    b[613]=90;
    b[614]=92;
    b[615]=91;
    b[616]=57;
    b[617]=15;
    b[618]=21;
    b[619]=57;
    b[620]=74;
    b[621]=91;
    b[622]=47;
    b[623]=51;
    b[624]=31;
    b[625]=21;
    b[626]=37;
    b[627]=40;
    b[628]=54;
    b[629]=30;
    b[630]=98;
    b[631]=25;
    b[632]=81;
    b[633]=16;
    b[634]=16;
    b[635]=2;
    b[636]=31;
    b[637]=39;
    b[638]=96;
    b[639]=4;
    b[640]=38;
    b[641]=80;
    b[642]=18;
    b[643]=21;
    b[644]=70;
    b[645]=62;
    b[646]=12;
    b[647]=79;
    b[648]=77;
    b[649]=85;
    b[650]=36;
    b[651]=4;
    b[652]=76;
    b[653]=83;
    b[654]=7;
    b[655]=59;
    b[656]=57;
    b[657]=44;
    b[658]=99;
    b[659]=11;
    b[660]=27;
    b[661]=50;
    b[662]=36;
    b[663]=60;
    b[664]=18;
    b[665]=5;
    b[666]=63;
    b[667]=49;
    b[668]=44;
    b[669]=11;
    b[670]=5;
    b[671]=34;
    b[672]=91;
    b[673]=75;
    b[674]=55;
    b[675]=14;
    b[676]=89;
    b[677]=68;
    b[678]=93;
    b[679]=18;
    b[680]=5;
    b[681]=82;
    b[682]=22;
    b[683]=82;
    b[684]=17;
    b[685]=30;
    b[686]=93;
    b[687]=74;
    b[688]=26;
    b[689]=93;
    b[690]=86;
    b[691]=53;
    b[692]=43;
    b[693]=74;
    b[694]=14;
    b[695]=13;
    b[696]=79;
    b[697]=77;
    b[698]=62;
    b[699]=75;
    b[700]=88;
    b[701]=19;
    b[702]=10;
    b[703]=32;
    b[704]=94;
    b[705]=17;
    b[706]=46;
    b[707]=35;
    b[708]=37;
    b[709]=91;
    b[710]=53;
    b[711]=43;
    b[712]=73;
    b[713]=28;
    b[714]=25;
    b[715]=91;
    b[716]=10;
    b[717]=18;
    b[718]=17;
    b[719]=36;
    b[720]=63;
    b[721]=55;
    b[722]=90;
    b[723]=58;
    b[724]=30;
    b[725]=4;
    b[726]=71;
    b[727]=61;
    b[728]=33;
    b[729]=85;
    b[730]=89;
    b[731]=73;
    b[732]=4;
    b[733]=51;
    b[734]=5;
    b[735]=50;
    b[736]=68;
    b[737]=3;
    b[738]=85;
    b[739]=6;
    b[740]=95;
    b[741]=39;
    b[742]=49;
    b[743]=20;
    b[744]=67;
    b[745]=26;
    b[746]=63;
    b[747]=77;
    b[748]=96;
    b[749]=81;
    b[750]=65;
    b[751]=60;
    b[752]=36;
    b[753]=55;
    b[754]=70;
    b[755]=18;
    b[756]=11;
    b[757]=42;
    b[758]=32;
    b[759]=96;
    b[760]=79;
    b[761]=21;
    b[762]=70;
    b[763]=84;
    b[764]=72;
    b[765]=27;
    b[766]=34;
    b[767]=40;
    b[768]=83;
    b[769]=72;
    b[770]=98;
    b[771]=30;
    b[772]=63;
    b[773]=47;
    b[774]=50;
    b[775]=30;
    b[776]=73;
    b[777]=14;
    b[778]=59;
    b[779]=22;
    b[780]=47;
    b[781]=24;
    b[782]=82;
    b[783]=35;
    b[784]=32;
    b[785]=4;
    b[786]=54;
    b[787]=43;
    b[788]=98;
    b[789]=86;
    b[790]=40;
    b[791]=78;
    b[792]=59;
    b[793]=62;
    b[794]=62;
    b[795]=83;
    b[796]=41;
    b[797]=48;
    b[798]=23;
    b[799]=24;
    b[800]=72;
    b[801]=22;
    b[802]=54;
    b[803]=35;
    b[804]=21;
    b[805]=57;
    b[806]=65;
    b[807]=47;
    b[808]=71;
    b[809]=76;
    b[810]=69;
    b[811]=18;
    b[812]=1;
    b[813]=3;
    b[814]=53;
    b[815]=33;
    b[816]=7;
    b[817]=59;
    b[818]=28;
    b[819]=6;
    b[820]=97;
    b[821]=20;
    b[822]=84;
    b[823]=8;
    b[824]=34;
    b[825]=98;
    b[826]=91;
    b[827]=76;
    b[828]=98;
    b[829]=15;
    b[830]=52;
    b[831]=71;
    b[832]=89;
    b[833]=59;
    b[834]=6;
    b[835]=10;
    b[836]=16;
    b[837]=24;
    b[838]=9;
    b[839]=39;
    b[840]=0;
    b[841]=78;
    b[842]=9;
    b[843]=53;
    b[844]=81;
    b[845]=14;
    b[846]=38;
    b[847]=89;
    b[848]=26;
    b[849]=67;
    b[850]=47;
    b[851]=23;
    b[852]=87;
    b[853]=31;
    b[854]=32;
    b[855]=22;
    b[856]=81;
    b[857]=75;
    b[858]=50;
    b[859]=79;
    b[860]=90;
    b[861]=54;
    b[862]=50;
    b[863]=31;
    b[864]=13;
    b[865]=57;
    b[866]=94;
    b[867]=81;
    b[868]=81;
    b[869]=3;
    b[870]=20;
    b[871]=33;
    b[872]=82;
    b[873]=81;
    b[874]=87;
    b[875]=15;
    b[876]=96;
    b[877]=25;
    b[878]=4;
    b[879]=22;
    b[880]=92;
    b[881]=51;
    b[882]=97;
    b[883]=32;
    b[884]=34;
    b[885]=81;
    b[886]=6;
    b[887]=15;
    b[888]=57;
    b[889]=8;
    b[890]=95;
    b[891]=99;
    b[892]=62;
    b[893]=97;
    b[894]=83;
    b[895]=76;
    b[896]=54;
    b[897]=77;
    b[898]=9;
    b[899]=87;
    b[900]=32;
    b[901]=82;
    b[902]=21;
    b[903]=66;
    b[904]=63;
    b[905]=60;
    b[906]=82;
    b[907]=11;
    b[908]=85;
    b[909]=86;
    b[910]=85;
    b[911]=30;
    b[912]=90;
    b[913]=83;
    b[914]=14;
    b[915]=76;
    b[916]=16;
    b[917]=20;
    b[918]=92;
    b[919]=25;
    b[920]=28;
    b[921]=39;
    b[922]=25;
    b[923]=90;
    b[924]=36;
    b[925]=60;
    b[926]=18;
    b[927]=43;
    b[928]=37;
    b[929]=28;
    b[930]=82;
    b[931]=21;
    b[932]=10;
    b[933]=55;
    b[934]=88;
    b[935]=25;
    b[936]=15;
    b[937]=70;
    b[938]=37;
    b[939]=53;
    b[940]=8;
    b[941]=22;
    b[942]=83;
    b[943]=50;
    b[944]=57;
    b[945]=97;
    b[946]=27;
    b[947]=26;
    b[948]=69;
    b[949]=71;
    b[950]=51;
    b[951]=49;
    b[952]=10;
    b[953]=28;
    b[954]=39;
    b[955]=98;
    b[956]=88;
    b[957]=10;
    b[958]=93;
    b[959]=77;
    b[960]=90;
    b[961]=76;
    b[962]=99;
    b[963]=52;
    b[964]=31;
    b[965]=87;
    b[966]=77;
    b[967]=99;
    b[968]=57;
    b[969]=66;
    b[970]=52;
    b[971]=17;
    b[972]=41;
    b[973]=35;
    b[974]=68;
    b[975]=98;
    b[976]=84;
    b[977]=95;
    b[978]=76;
    b[979]=5;
    b[980]=66;
    b[981]=28;
    b[982]=54;
    b[983]=28;
    b[984]=8;
    b[985]=93;
    b[986]=78;
    b[987]=97;
    b[988]=55;
    b[989]=72;
    b[990]=74;
    b[991]=45;
    b[992]=0;
    b[993]=25;
    b[994]=97;
    b[995]=83;
    b[996]=12;
    b[997]=27;
    b[998]=82;
    b[999]=21;
    b[1000]=93;
    b[1001]=34;
    b[1002]=39;
    b[1003]=34;
    b[1004]=21;
    b[1005]=59;
    b[1006]=85;
    b[1007]=57;
    b[1008]=54;
    b[1009]=61;
    b[1010]=62;
    b[1011]=72;
    b[1012]=41;
    b[1013]=16;
    b[1014]=52;
    b[1015]=50;
    b[1016]=62;
    b[1017]=82;
    b[1018]=99;
    b[1019]=17;
    b[1020]=54;
    b[1021]=73;
    b[1022]=15;
    b[1023]=6;
    b[1024]=51;
    b[1025]=64;
    b[1026]=90;
    b[1027]=63;
    b[1028]=91;
    b[1029]=72;
    b[1030]=37;
    b[1031]=37;
    b[1032]=59;
    b[1033]=28;
    b[1034]=71;
    b[1035]=80;
    b[1036]=87;
    b[1037]=56;
    b[1038]=90;
    b[1039]=41;
    b[1040]=70;
    b[1041]=52;
    b[1042]=65;
    b[1043]=11;
    b[1044]=69;
    b[1045]=17;
    b[1046]=61;
    b[1047]=83;
    b[1048]=51;
    b[1049]=12;
    b[1050]=0;
    b[1051]=6;
    b[1052]=38;
    b[1053]=67;
    b[1054]=64;
    b[1055]=89;
    b[1056]=32;
    b[1057]=54;
    b[1058]=4;
    b[1059]=75;
    b[1060]=79;
    b[1061]=41;
    b[1062]=12;
    b[1063]=38;
    b[1064]=69;
    b[1065]=36;
    b[1066]=70;
    b[1067]=56;
    b[1068]=44;
    b[1069]=60;
    b[1070]=49;
    b[1071]=14;
    b[1072]=65;
    b[1073]=14;
    b[1074]=26;
    b[1075]=86;
    b[1076]=83;
    b[1077]=39;
    b[1078]=69;
    b[1079]=35;
    b[1080]=52;
    b[1081]=21;
    b[1082]=93;
    b[1083]=90;
    b[1084]=89;
    b[1085]=9;
    b[1086]=31;
    b[1087]=73;
    b[1088]=64;
    b[1089]=35;
    b[1090]=48;
    b[1091]=95;
    b[1092]=77;
    b[1093]=13;
    b[1094]=33;
    b[1095]=98;
    b[1096]=49;
    b[1097]=55;
    b[1098]=55;
    b[1099]=93;
    b[1100]=68;
    b[1101]=56;
    b[1102]=60;
    b[1103]=33;
    b[1104]=23;
    b[1105]=86;
    b[1106]=71;
    b[1107]=58;
    b[1108]=77;
    b[1109]=40;
    b[1110]=45;
    b[1111]=81;
    b[1112]=61;
    b[1113]=90;
    b[1114]=23;
    b[1115]=50;
    b[1116]=0;
    b[1117]=54;
    b[1118]=75;
    b[1119]=64;
    b[1120]=42;
    b[1121]=24;
    b[1122]=59;
    b[1123]=19;
    b[1124]=89;
    b[1125]=44;
    b[1126]=69;
    b[1127]=38;
    b[1128]=51;
    b[1129]=76;
    b[1130]=83;
    b[1131]=19;
    b[1132]=33;
    b[1133]=43;
    b[1134]=4;
    b[1135]=56;
    b[1136]=81;
    b[1137]=75;
    b[1138]=66;
    b[1139]=11;
    b[1140]=67;
    b[1141]=12;
    b[1142]=92;
    b[1143]=29;
    b[1144]=2;
    b[1145]=68;
    b[1146]=31;
    b[1147]=2;
    b[1148]=74;
    b[1149]=7;
    b[1150]=18;
    b[1151]=16;
    b[1152]=83;
    b[1153]=77;
    b[1154]=87;
    b[1155]=72;
    b[1156]=73;
    b[1157]=57;
    b[1158]=62;
    b[1159]=25;
    b[1160]=33;
    b[1161]=97;
    b[1162]=96;
    b[1163]=18;
    b[1164]=41;
    b[1165]=53;
    b[1166]=26;
    b[1167]=74;
    b[1168]=80;
    b[1169]=93;
    b[1170]=85;
    b[1171]=48;
    b[1172]=5;
    b[1173]=30;
    b[1174]=29;
    b[1175]=59;
    b[1176]=98;
    b[1177]=60;
    b[1178]=62;
    b[1179]=24;
    b[1180]=19;
    b[1181]=80;
    b[1182]=41;
    b[1183]=2;
    b[1184]=10;
    b[1185]=80;
    b[1186]=26;
    b[1187]=83;
    b[1188]=89;
    b[1189]=40;
    b[1190]=8;
    b[1191]=23;
    b[1192]=38;
    b[1193]=57;
    b[1194]=93;
    b[1195]=31;
    b[1196]=10;
    b[1197]=20;
    b[1198]=5;
    b[1199]=90;
    b[1200]=13;
    b[1201]=91;
    b[1202]=38;
    b[1203]=70;
    b[1204]=21;
    b[1205]=67;
    b[1206]=29;
    b[1207]=71;
    b[1208]=80;
    b[1209]=43;
    b[1210]=95;
    b[1211]=99;
    b[1212]=24;
    b[1213]=88;
    b[1214]=54;
    b[1215]=86;
    b[1216]=69;
    b[1217]=32;
    b[1218]=69;
    b[1219]=10;
    b[1220]=73;
    b[1221]=30;
    b[1222]=33;
    b[1223]=63;
    b[1224]=87;
    b[1225]=79;
    b[1226]=94;
    b[1227]=49;
    b[1228]=99;
    b[1229]=51;
    b[1230]=39;
    b[1231]=64;
    b[1232]=42;
    b[1233]=30;
    b[1234]=86;
    b[1235]=15;
    b[1236]=49;
    b[1237]=15;
    b[1238]=86;
    b[1239]=81;
    b[1240]=11;
    b[1241]=34;
    b[1242]=33;
    b[1243]=87;
    b[1244]=22;
    b[1245]=87;
    b[1246]=73;
    b[1247]=43;
    b[1248]=19;
    b[1249]=42;
    b[1250]=54;
    b[1251]=44;
    b[1252]=24;
    b[1253]=39;
    b[1254]=59;
    b[1255]=63;
    b[1256]=18;
    b[1257]=53;
    b[1258]=12;
    b[1259]=69;
    b[1260]=5;
    b[1261]=4;
    b[1262]=33;
    b[1263]=99;
    b[1264]=34;
    b[1265]=19;
    b[1266]=15;
    b[1267]=35;
    b[1268]=87;
    b[1269]=53;
    b[1270]=69;
    b[1271]=50;
    b[1272]=87;
    b[1273]=2;
    b[1274]=37;
    b[1275]=62;
    b[1276]=89;
    b[1277]=10;
    b[1278]=5;
    b[1279]=60;
    b[1280]=4;
    b[1281]=11;
    b[1282]=57;
    b[1283]=29;
    b[1284]=3;
    b[1285]=16;
    b[1286]=92;
    b[1287]=21;
    b[1288]=22;
    b[1289]=5;
    b[1290]=43;
    b[1291]=79;
    b[1292]=61;
    b[1293]=28;
    b[1294]=78;
    b[1295]=47;
    b[1296]=0;
    b[1297]=45;
    b[1298]=82;
    b[1299]=87;
    b[1300]=99;
    b[1301]=51;
    b[1302]=89;
    b[1303]=86;
    b[1304]=53;
    b[1305]=26;
    b[1306]=48;
    b[1307]=94;
    b[1308]=36;
    b[1309]=6;
    b[1310]=7;
    b[1311]=92;
    b[1312]=17;
    b[1313]=64;
    b[1314]=21;
    b[1315]=20;
    b[1316]=80;
    b[1317]=66;
    b[1318]=94;
    b[1319]=54;
    b[1320]=23;
    b[1321]=37;
    b[1322]=33;
    b[1323]=84;
    b[1324]=17;
    b[1325]=12;
    b[1326]=31;
    b[1327]=17;
    b[1328]=9;
    b[1329]=65;
    b[1330]=56;
    b[1331]=8;
    b[1332]=69;
    b[1333]=45;
    b[1334]=95;
    b[1335]=22;
    b[1336]=71;
    b[1337]=95;
    b[1338]=69;
    b[1339]=59;
    b[1340]=1;
    b[1341]=76;
    b[1342]=52;
    b[1343]=71;
    b[1344]=40;
    b[1345]=25;
    b[1346]=43;
    b[1347]=72;
    b[1348]=91;
    b[1349]=89;
    b[1350]=27;
    b[1351]=66;
    b[1352]=78;
    b[1353]=12;
    b[1354]=50;
    b[1355]=96;
    b[1356]=24;
    b[1357]=33;
    b[1358]=13;
    b[1359]=86;
    b[1360]=99;
    b[1361]=70;
    b[1362]=94;
    b[1363]=68;
    b[1364]=15;
    b[1365]=41;
    b[1366]=42;
    b[1367]=39;
    b[1368]=37;
    b[1369]=63;
    b[1370]=98;
    b[1371]=90;
    b[1372]=39;
    b[1373]=2;
    b[1374]=13;
    b[1375]=31;
    b[1376]=28;
    b[1377]=57;
    b[1378]=4;
    b[1379]=71;
    b[1380]=46;
    b[1381]=83;
    b[1382]=38;
    b[1383]=25;
    b[1384]=95;
    b[1385]=40;
    b[1386]=21;
    b[1387]=72;
    b[1388]=26;
    b[1389]=34;
    b[1390]=58;
    b[1391]=25;
    b[1392]=56;
    b[1393]=52;
    b[1394]=45;
    b[1395]=72;
    b[1396]=46;
    b[1397]=39;
    b[1398]=11;
    b[1399]=83;
    b[1400]=3;
    b[1401]=61;
    b[1402]=25;
    b[1403]=42;
    b[1404]=16;
    b[1405]=39;
    b[1406]=74;
    b[1407]=44;
    b[1408]=96;
    b[1409]=30;
    b[1410]=67;
    b[1411]=94;
    b[1412]=13;
    b[1413]=57;
    b[1414]=19;
    b[1415]=60;
    b[1416]=50;
    b[1417]=92;
    b[1418]=32;
    b[1419]=76;
    b[1420]=79;
    b[1421]=90;
    b[1422]=53;
    b[1423]=35;
    b[1424]=95;
    b[1425]=98;
    b[1426]=7;
    b[1427]=41;
    b[1428]=37;
    b[1429]=70;
    b[1430]=76;
    b[1431]=40;
    b[1432]=84;
    b[1433]=1;
    b[1434]=83;
    b[1435]=0;
    b[1436]=92;
    b[1437]=9;
    b[1438]=96;
    b[1439]=40;
    b[1440]=39;
    b[1441]=63;
    b[1442]=35;
    b[1443]=4;
    b[1444]=73;
    b[1445]=6;
    b[1446]=64;
    b[1447]=23;
    b[1448]=51;
    b[1449]=49;
    b[1450]=51;
    b[1451]=30;
    b[1452]=39;
    b[1453]=4;
    b[1454]=65;
    b[1455]=86;
    b[1456]=2;
    b[1457]=25;
    b[1458]=79;
    b[1459]=91;
    b[1460]=47;
    b[1461]=7;
    b[1462]=84;
    b[1463]=31;
    b[1464]=61;
    b[1465]=19;
    b[1466]=31;
    b[1467]=53;
    b[1468]=28;
    b[1469]=27;
    b[1470]=94;
    b[1471]=19;
    b[1472]=43;
    b[1473]=81;
    b[1474]=23;
    b[1475]=68;
    b[1476]=87;
    b[1477]=39;
    b[1478]=43;
    b[1479]=38;
    b[1480]=88;
    b[1481]=94;
    b[1482]=20;
    b[1483]=80;
    b[1484]=98;
    b[1485]=86;
    b[1486]=18;
    b[1487]=52;
    b[1488]=63;
    b[1489]=98;
    b[1490]=95;
    b[1491]=10;
    b[1492]=5;
    b[1493]=79;
    b[1494]=42;
    b[1495]=66;
    b[1496]=98;
    b[1497]=25;
    b[1498]=72;
    b[1499]=78;
    b[1500]=53;
    b[1501]=66;
    b[1502]=97;
    b[1503]=48;
    b[1504]=47;
    b[1505]=72;
    b[1506]=16;
    b[1507]=86;
    b[1508]=12;
    b[1509]=59;
    b[1510]=77;
    b[1511]=0;
    b[1512]=53;
    b[1513]=97;
    b[1514]=32;
    b[1515]=3;
    b[1516]=35;
    b[1517]=51;
    b[1518]=7;
    b[1519]=98;
    b[1520]=49;
    b[1521]=54;
    b[1522]=61;
    b[1523]=6;
    b[1524]=34;
    b[1525]=3;
    b[1526]=25;
    b[1527]=84;
    b[1528]=28;
    b[1529]=97;
    b[1530]=63;
    b[1531]=33;
    b[1532]=15;
    b[1533]=60;
    b[1534]=81;
    b[1535]=14;
    b[1536]=85;
    b[1537]=97;
    b[1538]=0;
    b[1539]=97;
    b[1540]=8;
    b[1541]=29;
    b[1542]=49;
    b[1543]=13;
    b[1544]=79;
    b[1545]=34;
    b[1546]=16;
    b[1547]=14;
    b[1548]=85;
    b[1549]=75;
    b[1550]=65;
    b[1551]=86;
    b[1552]=30;
    b[1553]=26;
    b[1554]=92;
    b[1555]=16;
    b[1556]=29;
    b[1557]=69;
    b[1558]=52;
    b[1559]=9;
    b[1560]=66;
    b[1561]=15;
    b[1562]=95;
    b[1563]=33;
    b[1564]=28;
    b[1565]=76;
    b[1566]=47;
    b[1567]=13;
    b[1568]=26;
    b[1569]=0;
    b[1570]=62;
    b[1571]=86;
    b[1572]=29;
    b[1573]=63;
    b[1574]=0;
    b[1575]=8;
    b[1576]=97;
    b[1577]=16;
    b[1578]=75;
    b[1579]=82;
    b[1580]=44;
    b[1581]=40;
    b[1582]=20;
    b[1583]=26;
    b[1584]=18;
    b[1585]=65;
    b[1586]=94;
    b[1587]=99;
    b[1588]=34;
    b[1589]=46;
    b[1590]=8;
    b[1591]=53;
    b[1592]=62;
    b[1593]=3;
    b[1594]=86;
    b[1595]=42;
    b[1596]=32;
    b[1597]=34;
    b[1598]=7;
    b[1599]=10;
    b[1600]=34;
    b[1601]=69;
    b[1602]=96;
    b[1603]=15;
    b[1604]=84;
    b[1605]=96;
    b[1606]=24;
    b[1607]=82;
    b[1608]=65;
    b[1609]=51;
    b[1610]=16;
    b[1611]=61;
    b[1612]=43;
    b[1613]=37;
    b[1614]=87;
    b[1615]=61;
    b[1616]=2;
    b[1617]=81;
    b[1618]=60;
    b[1619]=88;
    b[1620]=79;
    b[1621]=20;
    b[1622]=41;
    b[1623]=93;
    b[1624]=24;
    b[1625]=28;
    b[1626]=35;
    b[1627]=8;
    b[1628]=62;
    b[1629]=42;
    b[1630]=70;
    b[1631]=96;
    b[1632]=63;
    b[1633]=66;
    b[1634]=11;
    b[1635]=0;
    b[1636]=15;
    b[1637]=87;
    b[1638]=34;
    b[1639]=32;
    b[1640]=90;
    b[1641]=50;
    b[1642]=93;
    b[1643]=33;
    b[1644]=39;
    b[1645]=80;
    b[1646]=94;
    b[1647]=93;
    b[1648]=13;
    b[1649]=54;
    b[1650]=82;
    b[1651]=44;
    b[1652]=75;
    b[1653]=23;
    b[1654]=38;
    b[1655]=51;
    b[1656]=51;
    b[1657]=73;
    b[1658]=11;
    b[1659]=65;
    b[1660]=68;
    b[1661]=81;
    b[1662]=13;
    b[1663]=83;
    b[1664]=99;
    b[1665]=77;
    b[1666]=35;
    b[1667]=14;
    b[1668]=64;
    b[1669]=69;
    b[1670]=46;
    b[1671]=7;
    b[1672]=72;
    b[1673]=91;
    b[1674]=40;
    b[1675]=11;
    b[1676]=23;
    b[1677]=87;
    b[1678]=57;
    b[1679]=36;
    b[1680]=93;
    b[1681]=39;
    b[1682]=81;
    b[1683]=20;
    b[1684]=14;
    b[1685]=71;
    b[1686]=71;
    b[1687]=18;
    b[1688]=96;
    b[1689]=34;
    b[1690]=83;
    b[1691]=64;
    b[1692]=67;
    b[1693]=97;
    b[1694]=0;
    b[1695]=67;
    b[1696]=74;
    b[1697]=35;
    b[1698]=33;
    b[1699]=90;
    b[1700]=57;
    b[1701]=32;
    b[1702]=49;
    b[1703]=29;
    b[1704]=23;
    b[1705]=90;
    b[1706]=92;
    b[1707]=47;
    b[1708]=29;
    b[1709]=49;
    b[1710]=35;
    b[1711]=22;
    b[1712]=40;
    b[1713]=68;
    b[1714]=43;
    b[1715]=55;
    b[1716]=39;
    b[1717]=66;
    b[1718]=25;
    b[1719]=36;
    b[1720]=53;
    b[1721]=60;
    b[1722]=52;
    b[1723]=20;
    b[1724]=57;
    b[1725]=4;
    b[1726]=87;
    b[1727]=83;
    b[1728]=40;
    b[1729]=21;
    b[1730]=26;
    b[1731]=97;
    b[1732]=5;
    b[1733]=27;
    b[1734]=78;
    b[1735]=28;
    b[1736]=69;
    b[1737]=70;
    b[1738]=27;
    b[1739]=98;
    b[1740]=20;
    b[1741]=63;
    b[1742]=21;
    b[1743]=60;
    b[1744]=83;
    b[1745]=16;
    b[1746]=67;
    b[1747]=23;
    b[1748]=82;
    b[1749]=92;
    b[1750]=11;
    b[1751]=35;
    b[1752]=53;
    b[1753]=63;
    b[1754]=8;
    b[1755]=62;
    b[1756]=68;
    b[1757]=95;
    b[1758]=98;
    b[1759]=60;
    b[1760]=68;
    b[1761]=76;
    b[1762]=9;
    b[1763]=73;
    b[1764]=3;
    b[1765]=87;
    b[1766]=54;
    b[1767]=73;
    b[1768]=57;
    b[1769]=81;
    b[1770]=23;
    b[1771]=29;
    b[1772]=96;
    b[1773]=44;
    b[1774]=42;
    b[1775]=80;
    b[1776]=12;
    b[1777]=9;
    b[1778]=55;
    b[1779]=47;
    b[1780]=54;
    b[1781]=66;
    b[1782]=34;
    b[1783]=59;
    b[1784]=81;
    b[1785]=42;
    b[1786]=73;
    b[1787]=1;
    b[1788]=38;
    b[1789]=71;
    b[1790]=13;
    b[1791]=58;
    b[1792]=99;
    b[1793]=22;
    b[1794]=84;
    b[1795]=55;
    b[1796]=61;
    b[1797]=90;
    b[1798]=80;
    b[1799]=71;
    b[1800]=23;
    b[1801]=3;
    b[1802]=0;
    b[1803]=20;
    b[1804]=0;
    b[1805]=42;
    b[1806]=52;
    b[1807]=12;
    b[1808]=4;
    b[1809]=7;
    b[1810]=59;
    b[1811]=58;
    b[1812]=25;
    b[1813]=94;
    b[1814]=17;
    b[1815]=58;
    b[1816]=36;
    b[1817]=90;
    b[1818]=60;
    b[1819]=26;
    b[1820]=14;
    b[1821]=73;
    b[1822]=37;
    b[1823]=65;
    b[1824]=48;
    b[1825]=21;
    b[1826]=20;
    b[1827]=9;
    b[1828]=63;
    b[1829]=0;
    b[1830]=32;
    b[1831]=86;
    b[1832]=4;
    b[1833]=33;
    b[1834]=58;
    b[1835]=56;
    b[1836]=27;
    b[1837]=10;
    b[1838]=68;
    b[1839]=31;
    b[1840]=69;
    b[1841]=28;
    b[1842]=41;
    b[1843]=46;
    b[1844]=74;
    b[1845]=58;
    b[1846]=5;
    b[1847]=10;
    b[1848]=1;
    b[1849]=65;
    b[1850]=89;
    b[1851]=67;
    b[1852]=90;
    b[1853]=26;
    b[1854]=32;
    b[1855]=38;
    b[1856]=99;
    b[1857]=5;
    b[1858]=0;
    b[1859]=62;
    b[1860]=57;
    b[1861]=32;
    b[1862]=48;
    b[1863]=61;
    b[1864]=17;
    b[1865]=7;
    b[1866]=69;
    b[1867]=97;
    b[1868]=69;
    b[1869]=38;
    b[1870]=28;
    b[1871]=39;
    b[1872]=18;
    b[1873]=70;
    b[1874]=85;
    b[1875]=92;
    b[1876]=80;
    b[1877]=42;
    b[1878]=54;
    b[1879]=33;
    b[1880]=7;
    b[1881]=43;
    b[1882]=0;
    b[1883]=50;
    b[1884]=21;
    b[1885]=85;
    b[1886]=88;
    b[1887]=20;
    b[1888]=90;
    b[1889]=40;
    b[1890]=34;
    b[1891]=47;
    b[1892]=25;
    b[1893]=83;
    b[1894]=61;
    b[1895]=94;
    b[1896]=42;
    b[1897]=30;
    b[1898]=91;
    b[1899]=63;
    b[1900]=20;
    b[1901]=20;
    b[1902]=54;
    b[1903]=38;
    b[1904]=42;
    b[1905]=92;
    b[1906]=30;
    b[1907]=22;
    b[1908]=34;
    b[1909]=85;
    b[1910]=8;
    b[1911]=94;
    b[1912]=80;
    b[1913]=8;
    b[1914]=44;
    b[1915]=2;
    b[1916]=45;
    b[1917]=84;
    b[1918]=22;
    b[1919]=87;
    b[1920]=25;
    b[1921]=57;
    b[1922]=35;
    b[1923]=2;
    b[1924]=92;
    b[1925]=48;
    b[1926]=96;
    b[1927]=86;
    b[1928]=30;
    b[1929]=40;
    b[1930]=49;
    b[1931]=51;
    b[1932]=12;
    b[1933]=56;
    b[1934]=89;
    b[1935]=54;
    b[1936]=48;
    b[1937]=72;
    b[1938]=28;
    b[1939]=82;
    b[1940]=57;
    b[1941]=88;
    b[1942]=76;
    b[1943]=37;
    b[1944]=97;
    b[1945]=20;
    b[1946]=39;
    b[1947]=94;
    b[1948]=5;
    b[1949]=14;
    b[1950]=82;
    b[1951]=82;
    b[1952]=23;
    b[1953]=69;
    b[1954]=36;
    b[1955]=15;
    b[1956]=17;
    b[1957]=84;
    b[1958]=53;
    b[1959]=99;
    b[1960]=24;
    b[1961]=54;
    b[1962]=50;
    b[1963]=36;
    b[1964]=10;
    b[1965]=92;
    b[1966]=42;
    b[1967]=58;
    b[1968]=64;
    b[1969]=23;
    b[1970]=41;
    b[1971]=21;
    b[1972]=11;
    b[1973]=69;
    b[1974]=10;
    b[1975]=60;
    b[1976]=90;
    b[1977]=2;
    b[1978]=55;
    b[1979]=47;
    b[1980]=16;
    b[1981]=89;
    b[1982]=81;
    b[1983]=39;
    b[1984]=58;
    b[1985]=17;
    b[1986]=6;
    b[1987]=75;
    b[1988]=1;
    b[1989]=11;
    b[1990]=74;
    b[1991]=78;
    b[1992]=65;
    b[1993]=77;
    b[1994]=66;
    b[1995]=76;
    b[1996]=69;
    b[1997]=61;
    b[1998]=34;
    b[1999]=33;
    return b;
}

double dotProduct(vector<double> a, vector<double> b, int size) {
	double dotProd = 0.0;
	for (int i = 0; i < size; i++) {
		dotProd += (a[i] * b[i]);
	}
	return dotProd;
}

vector<double> subtractVec(vector<double> a, vector<double> b, int size) {
    vector<double> res(size);
    for (int i = 0; i < size; i++) {
        res[i] = a[i] - b[i];
    }
    return res;
}

vector<double> matrixVector(vector<vector<double>> matrix, vector<double> v, int size) {
    vector <double> res(size);
	for (int i = 0; i < size; i++) {
		res[i] = 0;
		for (int j = 0; j < size; j++) {
			res[i] += matrix[i][j] * v[j];
		}
	}
	return res;
}

/* Conjugate Gradient Method: iterative method for efficiently solving linear systems of equations: Ax=b
    Step 1: Compute gradient: g(t) = Ax(t - 1) - b
    Step 2: if g(t)^T g(t) < epsilon => return
    Step 3: Compute direction vector: d(t)
    Step 4: Compute step size: s(t)
    Step 5: Compute new aproximation: x(t) = x(t-1) + s(t)d(t)
*/
vector<double> cg(vector<vector<double>> A, vector<double> b, int size, vector<double> x) {
    vector<double> g(size); //gradient, inicializar na primeira iteraçao?
    vector<double> d = subtractVec(b, matrixVector(A, x, size), size); //initial direction
    double s; //step size

    //auxiliar
    vector<double> op(size);
    double denom1 = 0;
    double denom2 = 0;
    double num1 = 0;
    double num2 = 0;
    /* Dsitribuir as iteraçoes pelos mpi nodes */
    for(int t = 0; t < MAXITER; t++) {
        cout << "============Iteration number:============" << t << endl;
        //MPI: esperar para receber valor de g(t-1) do node anterior
        if(t != 0) denom1 = dotProduct(g, g, size);
        if(debug)
            cout << "denom1: " << denom1 << endl;

        //step 1
        //Ax(t-1)
        //MPI: esperar para receber valor de x(t-1) do node anterior
        op = matrixVector(A, x, size);
        if(debug){
            cout << "Ax(t-1): " << endl;
            for(int i = 0; i < size; i++) {
                cout << op[i] << endl;
            }
        }
            
        //g(t) = Ax(t-1) - b
        g =  subtractVec(op, b, size);
        if(debug) {
            cout << "g(t): " << endl;
            for(int i = 0; i < size; i++) {
                cout << g[i] << endl;
            }
        }
        

        //step 2
        //g(t)^T g(t)
        num1 = dotProduct(g, g, size);
        if(debug) cout << "num1: " << num1 << endl;        
        if (num1 < epsilon) break;

        //step 3
        //d(t) = -g(t) + (g(t)^T g(t))/(g(t-1)^T g(t-1)) * d(t-1)
        //se estivermos na iteracao 0, a direcao foi ja calculada no inicio da funcao com o residuo
        for(int i = 0; i < size && t != 0; i++) {
             d[i] = -g[i] + (num1/denom1) * d[i];
            if(debug) {
                cout << "-g[i]: " << -g[i] << endl;
                cout << "(num1/denom1): " << (num1/denom1) << endl;
                cout << "d[i]: " << d[i] << endl;
                cout << "d(t)[" << i << "]: " << d[i] << endl;
            }
            
        }
        //d(t)^T g(t)
        num2 = dotProduct(d, g, size);

        //A*d(t)
        op = matrixVector(A, d, size);

        denom2 = dotProduct(d, op, size);
        s = -num2/denom2;
        if(debug){
            cout << "num2: " << num2 << endl;
            cout << "denom2: " << denom2 << endl;
            cout << "s: " << s << endl;
        }
        for(int i = 0; i < size; i++) {
            x[i] = x[i] + s*d[i];
        }
        if(debug) {
            cout << "x(t): " << endl;
            for(int i = 0; i < size; i++) {
                cout << x[i] << endl;
            }
        }
    }
    return x;
}

void processInput(int argc, char* argv[]) {
    for(int i = 0; i < argc; i++) {
        if(string(argv[i]) == "-d") {
            debug = true;
        }
        if(string(argv[i]) == "-f") {
            input_file = string(argv[i+1]);
        }
    }
}

int main (int argc, char* argv[]) {
    double exec_time;       /* execution time */
    processInput(argc, argv);

    vector<vector<double>> A = buildMatrix(input_file);
    vector<double> b = buildVector(input_file);
    int size = b.size();
    exec_time = -omp_get_wtime();
    //num max de threads
    vector<double> x = cg(A, b, size, b);
    exec_time += omp_get_wtime();
    fprintf(stdout, "%.10fs\n", exec_time);
    double sum = 0;
    for(int i = 0; i < size; i++) sum += x[i];
    cout << "Sum: " << sum << endl;
    return 0;
}